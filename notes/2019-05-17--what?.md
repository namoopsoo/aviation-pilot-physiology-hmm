### What
Summarizing what happened [yesterday](https://github.com/namoopsoo/aviation-pilot-physiology-hmm/blob/master/notes/2019-05-15-aviation-rnn.ipynb)

#### Initial attempt was missing a lot of data
```python
# First model train, 
%time out, model = runner()
# => 

Start make_data 2019-05-16 13:41:08
Start building training set 2019-05-16 13:41:08
Start building testing set 2019-05-16 13:41:09
Start bake_model 2019-05-16 13:41:10
Train... 2019-05-16 13:41:11
Train on 91874 samples, validate on 91876 samples
Epoch 1/2
 - 874s - loss: 0.1881 - acc: 0.1129 - val_loss: 1.0480e-07 - val_acc: 0.2500
Epoch 2/2
 - 893s - loss: 0.1271 - acc: 0.0466 - val_loss: 1.0480e-07 - val_acc: 0.0000e+00
CPU times: user 1h 18min 13s, sys: 32min 39s, total: 1h 50min 53s
Wall time: 29min 30s
```
* I looked at the output classes, and crap.. but good thing it only took `29 min`
* The reason why was i have a bug in `get_windows()` , I forgot to cycle through all of the choices.
```python
# - ok darn looks like the input data looks corrupt since theres just one class represented
print('Counter y test original', Counter(outdata['y_test_original']))
print('Counter predict classes', Counter(predict_classes))
print(len(Counter(outdata['y_test_original'])))
print (outdata['y_test'].shape)
Counter y test original Counter({'C': 91876})
Counter predict classes Counter({2: 91876})
```
```python
# There are not enough sequences. Only ~91876 , 
# - but should be  around  447652 - 256 . 
#
# ipdb> pp choices
# ([1], [0, 1], ['CA', 'DA', 'SS'])
# 
# ipdb> pp crew, seat, experiment
# (1, 0, 'CA')
#
# - so only the first choice was being used to build sequences.
```

#### Take two
* Okay, After fixing that bug and adding an assertion to prevent that in the future
* So now with the particular `make_data` call below, specifying `percent_of_data=1`, 
the metadata shows `A, B, C and D` are all represented.
```
In [325]:
# ...after some more troubleshooting...
with ipdb.launch_ipdb_on_exception():
    outdata = make_data(df, crews={'training': [1],
                        'test': [2]},
              sequence_window=256, percent_of_data=1,
             feature_cols={'r': simple_scaler})
Start building training set 2019-05-16 17:06:35 EST
Start building testing set 2019-05-16 17:06:40 EST
In [326]:
outdata['metadata']
Out[326]:
{'output': {'shapes': {'x_train': (446110, 256, 1),
   'y_train': (446110, 4),
   'x_test': (551326, 256, 1),
   'y_test': (551326, 4),
   'y_train_original': (446110,),
   'y_test_original': (551326,),
   'traindf': (447652, 7),
   'testdf': (552868, 7)},
  "Counter(outdata['y_train_original'])": {'A': 234352,
   'C': 180851,
   'D': 23218,
   'B': 7689},
  "Counter(outdata['y_test_original'])": {'C': 183718,
   'A': 325198,
   'D': 27039,
   'B': 15371}},
 'input': {'kwargs': {'percent_of_data': 1,
   'sequence_window': 256,
   'feature_cols': ['r']}},
 'data_ts': '2019-05-16 17:06:47 EST'}
 ```
